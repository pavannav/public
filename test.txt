variable "psc_enabled" {
  description = "Enable PSC for this SQL instance"
  type        = bool
  default     = false
}

variable "psc_allowed_consumer_projects" {
  description = "List of consumer projects allowed to access via PSC"
  type        = list(string)
  default     = []
}
------
ip_configuration {
  ipv4_enabled    = false
  private_network = var.network

  dynamic "psc_config" {
    for_each = var.psc_enabled ? [1] : []
    content {
      psc_enabled               = true
      allowed_consumer_projects = var.psc_allowed_consumer_projects
    }
  }
}

----------
module "sql" {
  source = "./modules/sql"

  psc_enabled = true
  psc_allowed_consumer_projects = ["project-1", "project-2"]
}






=================

gcloud compute url-maps create delivery-url-map \
  --default-service=projects/amc-q-trans/global/backendServices/amc-q-trans-delivery-elb-delivery-be \
  --path-matcher-name=matcher1 \
  --path-rule='/get/*=projects/amc-q-trans/global/backendServices/amc-q-trans-delivery-elb-delivery-be' \
  --path-rule='/get/*=projects/amc-q-trans/global/backendServices/amc-q-trans-delivery-elb-delivery-be-v2' \
  --url-rewrite=pathPrefixRewrite=/ \
  --weighted-backend-service=projects/amc-q-trans/global/backendServices/amc-q-trans-delivery-elb-delivery-be:50 \
  --weighted-backend-service=projects/amc-q-trans/global/backendServices/amc-q-trans-delivery-elb-delivery-be-v2:50

